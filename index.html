<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link rel="stylesheet" href="css/style.css">

</head>
<body>
    <header>
        <div id="header-data" class="container-full container-flex">
            <img id="logo" src="assets/mia-logo.svg" alt="Maastricht Institute of Farts">
            <div class="container-grid container-grid-flex-item-center">
                <h3><span>7 november 2022</span> Verzameld eindwerk periode 1.1 van studenten Communication & Multimedia Design / Zuyd Hogeschool </h3>
            </div>
        </div>
        <div id="header-content" class="container-grid clearfix">
            <h1>The Design Papers</h1>
            <h2>Een verzameling artikelen over betekenisvol ontwerpen. Vier themaâ€™s zijn onderzocht door 1e jaars studenten Communication en Multimedia Design, Zuyd Hogeschool Maastricht. Hun eerste uitdaging in het doen van onderzoek, het maken van content en het ontwerpen en ontwikkelen van een digitaal medium. Op weg naar een designtoekomst.</h2>
        </div>
    </header>

    <main>
        <div id="filter" class="container-grid container-flex">
            <h3>Kies categorie</h3>
            <ul>
                <li>
                    <button class="btn filter-button cat-art" data-filter="Art">Kunst</button>
                </li>
                <li>
                    <button class="btn filter-button cat-design" data-filter="Design">Design</button>
                </li>
                <li>
                    <button class="btn filter-button cat-tech" data-filter="Technologie">Technologie</button>
                </li>
                <li>
                    <button class="btn filter-button cat-eth" data-filter="Ethiek">Ethiek</button>
                </li>
                </ul>
        </div>
        <div id="search" class="container-grid container-flex">
            
            <input type="text" id="search-btn" placeholder="Zoek op naam of studentnummer">

        </div>


        <div id="student-list" class="container-grid container-flex">
            <h3>Kies student</h3>
            <ul id="classes">
                <li class="class class-1a"><h4>Klas 1A</h4>
                    <ul class="class-sub-names">
                        <li>Subitem 1</li>
                        <li>Subitem 2</li>
                    </ul>
                </li>
                <li class="class class-1b"><h4>Klas 1B</h4>
                    <ul class="class-sub-names">
                        <li>Subitem 1</li>
                        <li>Subitem 2</li>
                    </ul>
                </li>
                <li class="class class-1c"><h4>Klas 1C</h4>
                    <ul class="class-sub-names">
                        <li>Subitem 1</li>
                        <li>Subitem 2</li>
                    </ul>
                </li>
                <li class="class class-1d"><h4>Klas 1D</h4>
                    <ul class="class-sub-names">
                        <li>Subitem 1</li>
                        <li>Subitem 2</li>
                    </ul>
                </li>
            </ul>
        </div>
        <div id="thumb-wrapper">
            <!-- <div class="thumb-cont container-grid container-flex">

            </div> -->
        </div>
    </main>


   
   
    
    <script>

        //example array student work urls
        const urls = [
        "https://mia-mmt1-2122.github.io/city-pop-milavberkel/",
        "https://jsonplaceholder.typicode.com/comments/2",
        "https://jsonplaceholder.typicode.com/comments/3",
        "https://mia-mmt4-2122.github.io/sharing-like-a-pro-Juulkeuuuh/",
        "https://vincentsijben.github.io/will-wacky-website/",
        "https://mia-mmt1-2122.github.io/city-pop-milavberkel/",
        "https://jsonplaceholder.typicode.com/comments/2",
        "https://jsonplaceholder.typicode.com/comments/3",
        "https://mia-mmt4-2122.github.io/sharing-like-a-pro-Juulkeuuuh/",
        "https://vincentsijben.github.io/will-wacky-website/",
        "https://mia-mmt1-2122.github.io/city-pop-milavberkel/",
        "https://jsonplaceholder.typicode.com/comments/2",
        "https://jsonplaceholder.typicode.com/comments/3",
        "https://mia-mmt4-2122.github.io/sharing-like-a-pro-Juulkeuuuh/",
        "https://vincentsijben.github.io/will-wacky-website/", 
        "https://mia-mmt4-2122.github.io/sharing-like-a-pro-Juulkeuuuh/",
        "https://vincentsijben.github.io/will-wacky-website/",
        "https://mia-mmt1-2122.github.io/city-pop-milavberkel/",
        "https://jsonplaceholder.typicode.com/comments/2",
        "https://jsonplaceholder.typicode.com/comments/3",
        "https://mia-mmt4-2122.github.io/sharing-like-a-pro-Juulkeuuuh/",
        "https://vincentsijben.github.io/will-wacky-website/"
        ];
    
        //global vars
        const container = document.querySelector('#thumb-wrapper');
    
        (async () => {
            // await all urls from array
            const response = await Promise.all(urls.map(u => fetch(u)))
            
           
            // loop trough response with a maximum of 18 items

            for (let i = 0; i < 18; i++) {
                // random function mix max
                function randomIntFromInterval(min, max) { 
                    return Math.floor(Math.random() * (max - min + 1) + min)
                }
                
               
                

                // build loop vars
                const text = await response[i].text();
                const html = document.createElement("html");
                html.innerHTML = text;
                
                const url = html.querySelector('meta[name="twitter:site"]')?.getAttribute("content") || "";
                const urlArticle = html.querySelector('meta[name="twitter:article:url"]')?.getAttribute("content") || "#";
                const category = html.querySelector('meta[name="twitter:category"]')?.getAttribute("content") || "Geen categorie";
                const creator = html.querySelector('meta[name="twitter:creator"]')?.getAttribute("content") || "Geen naam";
                const title = html.querySelector('meta[name="twitter:title"]')?.getAttribute("content") || "";
                const rndInt = randomIntFromInterval(20, 60)
                const image = html.querySelector('meta[name="twitter:image"]')?.getAttribute("content") || `https://generative-placeholders.glitch.me/image?width=900&height=900&style=cellular-automata&cells=${rndInt}`;
                
                // //img
                const img = document.createElement("img");
                img.setAttribute("src",image);
                // give img the title as alt text, when no title is available, give it the url
                img.setAttribute("alt", title || "CMD student werk");
                // if image is not found, use placeholder
                img.onerror = function() {
                    this.onerror=null;
                    this.src = 'https://generative-placeholders.glitch.me/image?width=900&height=900&style=cellular-automata&cells=${rndInt}';
                }

                // // h4 category
                const h4 = document.createElement("h4");
                h4.innerText = category;
               
    
                // // h3 article title
                const h3 = document.createElement("h3");
                h3.innerText = title;
                // add 3 dots in text when title is longer than 110 characters   
                if (h3.innerText.length > 110) {
                    h3.innerText = h3.innerText.substring(0, 110) + "...";
                }
    
                // // student naam
                const p = document.createElement("p");
                p.innerText = creator;
    
                // // url article
                // const a = document.createElement("a");
                // a.setAttribute("href", urlArticle);
                // a.innerText = creator;
                // thumb.appendChild(a);
                // container.append(thumb);

                // build thumb nodes 
                const thumb = document.createElement("a");
                thumb.setAttribute("href", urlArticle);
                thumb.classList.add("thumb");
                thumb.appendChild(img);
                thumb.appendChild(h4);
                thumb.appendChild(h3);
                thumb.appendChild(p);

                // if the href of the thumb is a "#" the prevent default link behaviour
                if (thumb.getAttribute("href") == "#") {
                    thumb.addEventListener('click', function(e) {
                        e.preventDefault();
                    });
                }
       
                // wrap every 9 thumb inside thumb-cont
                if (i % 9 === 0) {
                    const thumbCont = document.createElement("div");
                    thumbCont.classList.add("thumb-cont");
                    thumbCont.classList.add("container-grid");
                    thumbCont.classList.add("container-flex");
                    thumbCont.appendChild(thumb);
                    container.appendChild(thumbCont);
                } else {
                    const thumbCont = document.querySelector(".thumb-cont:last-child");
                    thumbCont.appendChild(thumb);
                }
                

            }
             // loop trough all divs with the class thumb-cont, only after the first thumb-cont add a div
             
            const thumbConts = document.querySelectorAll(".thumb-cont");
            for (let i = 0; i < thumbConts.length; i++) {

                console.log(i)
               
                if (i == 0) {
                    
                    const fullWrap = document.createElement("div");
                    fullWrap.classList.add("image-wrap");
                    thumbConts[i].after(fullWrap);
                    //add extra div inside fullWrap named overlay
                    const overlay = document.createElement("div");
                    overlay.classList.add("overlay");
                    fullWrap.appendChild(overlay);

                    // // give image-wrap a random background image from generative placeholders
                    // const rndInt = randomIntFromInterval(20, 60)
                    // fullWrap.style.backgroundImage = `url(https://generative-placeholders.glitch.me/image?width=900&height=900&style=cellular-automata&cells=${rndInt})`;
            
                }
            }

           
    
        })()

       

    
    </script>
</body>
</html>